var FPF_MediaUploader=function(){function e(){this.initEvents()}var t=e.prototype;return t.initEvents=function(){document.addEventListener("click",function(e){this.initAddButton(e),this.initRemoveButton(e)}.bind(this))},t.initAddButton=function(e){var r,a,d,l=e.target.closest(".fpf-media-uploader-add");l&&(r=l.closest(".fpf-media-uploader-wrapper"),a=r.getAttribute("data-media"),d=wp.media({title:"Insert media file",library:{type:"url"==a?"audio":"image"},button:{text:"Use this media file"},multiple:!1}).on("select",function(){var e=d.state().get("selection").first().toJSON(),t=(l.classList.add("added-item"),r.querySelector('input[type="hidden"]')),i=(t.value=e.url,new Event("input",{bubbles:!0,cancelable:!0}));t.dispatchEvent(i),r.querySelector(".fpf-media-uploader-remove").classList.add("is-visible"),a&&("image"==a?r.querySelector(".fpf-media-uploader-preview img").setAttribute("src",e.url):"url"==a&&(r.querySelector(".preview-url").innerHTML=e.url),r.querySelector(".fpf-media-uploader-preview").classList.add("is-visible"))}).open(),e.preventDefault())},t.initRemoveButton=function(e){var t,i=e.target.closest(".fpf-media-uploader-remove");i&&(t=(i=i.closest(".fpf-media-uploader-wrapper")).getAttribute("data-media"),i.querySelector(".fpf-media-uploader-add").classList.remove("added-item"),i.querySelector('input[type="hidden"]').value="",i.querySelector(".fpf-media-uploader-remove").classList.remove("is-visible"),t&&("image"==t?i.querySelector(".fpf-media-uploader-preview img").setAttribute("src",""):"url"==t&&(i.querySelector(".preview-url").innerHTML=""),i.querySelector(".fpf-media-uploader-preview").classList.remove("is-visible")),e.preventDefault())},e}();document.addEventListener("DOMContentLoaded",function(e){new FPF_MediaUploader});

