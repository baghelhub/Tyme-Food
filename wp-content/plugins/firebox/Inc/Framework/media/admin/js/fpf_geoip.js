var FPFramework_GeoIP=function(){function e(){this.handleDownloadDB()}return e.prototype.handleDownloadDB=function(){var r,e=document.querySelector(".GeoIPUpdateDbButton");e&&(r=e.nextElementSibling.value,e.addEventListener("click",function(e){var n="",t=e.target.closest(".fpf-fields-wrapper"),t=(t&&t.querySelector(".geoip-license-key")&&(n=t.querySelector(".geoip-license-key").value),e.target.getAttribute("data-task")),a=new FormData,o=(a.append("nonce",r),a.append("action","fpf_on_geoip_ajax"),a.append("task",t),a.append("license_key",n),e.target);o.classList.remove("btn-danger"),o.innerHTML=fpf_js_object.FPF_DOWNLOADING_UPDATES_PLEASE_WAIT,o.classList.add("btn-working"),fetch(fpf_js_object.ajax_url,{method:"POST",body:a}).then(function(e){return e.json()}).then(function(e){e?("1"!=e&&"refresh"!=e||(o.innerHTML=fpf_js_object.FPF_DATABASE_UPDATED,o.classList.add("btn-success")),"refresh"==e?location.reload():"1"!=e&&(o.innerHTML=e,o.classList.remove("btn-success"),o.classList.add("btn-danger"))):(o.innerHTML=e,o.classList.add("btn-danger"))}).finally(function(){o.classList.remove("btn-working")}),e.preventDefault()}))},e}();document.addEventListener("DOMContentLoaded",function(e){new FPFramework_GeoIP});

