jQuery(document).ready(function($){let a=0,b="",c=-1,d=function(c,d,b){if(b){let a=new Date;a.setTime(a.getTime()+864e5*b),a.toGMTString()}document.cookie=escape(c)+"="+escape(d)+"; path=/; SameSite=Lax"},e=function(e){let c=escape(e)+"=",d=document.cookie.split(";");for(let b=0;b<d.length;b++){let a=d[b];for(;" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(c))return unescape(a.substring(c.length,a.length))}return null},f=function(a,b){url=cx_data.site_url+"/wp-json/couponx/v1/update_widget_stats",$.post({url:url,headers:{"X-WP-Nonce":cx_data.nonce},data:{nonce:cx_data.nonce,id:a,key:b},success:function(a){console.log(a)}})},g=function(a){if(b=e("couponx_unique"+a),coupon_widget_id="tab-box-front-"+a,!($("#"+coupon_widget_id+" .coupon-code-link").length>0)||2!=$("#"+coupon_widget_id+" .coupon-code-link").attr("data-type")){var c=$("#"+coupon_widget_id+' .coupon-code-email-text input[name="couponapp-email"]').length;if(null==b&&"1"!=c){let f=cx_data.site_url+"/wp-json/couponx/v1/generate_coupon";coupon_code=$(".cx-code").val(),$.post({url:f,headers:{"X-WP-Nonce":cx_data.nonce},data:{id:a,coupon_code:coupon_code,nonce:cx_data.nonce},success:function(c){if(200==c.status){let b=c.code.code;c.code.id;let e=$(".cx-code").data("valid");if(d("couponx_unique"+a,b,e),$("#"+coupon_widget_id+" .cx-code").length>0&&($("#"+coupon_widget_id+" .cx-code").val(b),$("#"+coupon_widget_id+" .tab-box-couponcode-content .coupon-code-text").show()),$("#"+coupon_widget_id+" .code").length>0&&$("#"+coupon_widget_id+" .code").text(b),$("#copy-coupon-inputcode-"+a).length>0&&$("#copy-coupon-inputcode-"+a).val(b),$("#"+coupon_widget_id+" .coupon-code-link").length>0){let f=(href=$("#"+coupon_widget_id+" .coupon-code-link").attr("data-url"))+b;$("#"+coupon_widget_id+" .coupon-code-link").attr("href",f)}}}})}else $("#"+coupon_widget_id+" .cx-code").length>0&&$("#"+coupon_widget_id+" .cx-code").val(b),$("#"+coupon_widget_id+" .code").length>0&&$("#"+coupon_widget_id+" .code").text(b),$("#copy-coupon-inputcode-"+a).length>0&&$("#copy-coupon-inputcode-"+a).val(b),$("#"+coupon_widget_id+" .coupon-code-link").length>0&&(href=$("#"+coupon_widget_id+" .coupon-code-link").attr("data-url"),type=$("#"+coupon_widget_id+" .coupon-code-link").attr("data-type"),1==type&&(link=href+b,$("#"+coupon_widget_id+" .coupon-code-link").attr("href",link)))}},h=function(a){$(window).scroll(function(){if("0"!==(container=$("#tab-box-front-"+a)).data("scroll")){let d=$(document).height()-$(window).height(),b=$(window).scrollTop();if(0!=b){let e=b/d*100,f=parseInt(container.data("scroll")),g=localStorage.getItem("couponapp_show"+a);e>=f&&c!=a&&"yes"!=g&&(c=a,container.removeClass("hide"),container.find(".tab-box-wrap").removeClass("hide"),localStorage.setItem("couponapp_scroll"+a,"yes"),localStorage.setItem("couponapp_show"+a,"yes"))}}})},i=function(a){localStorage.removeItem("is_updatevisitor"+a),localStorage.removeItem("is_updatecouponopen"+a),localStorage.removeItem("is_updatecouponcodeget"+a),localStorage.removeItem("couponapp_close"+a),localStorage.removeItem("couponapp_show"+a),localStorage.removeItem("couponapp_scroll"+a),localStorage.removeItem("couponapp_close_widget"+a),localStorage.removeItem("couponapp_tab_hide"+a),localStorage.removeItem("show_coupon_code"+a),localStorage.removeItem("couponapp_pending_message"+a),localStorage.removeItem("couponapp_open"+a),name="couponx_unique"+a,document.cookie=escape(name)+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/; SameSite=Lax",name="couponx-exist-"+a,document.cookie=escape(name)+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/; SameSite=Lax"},j=function(b){if(1!=get_cookie(cookie_name="cx_logged_"+b)&&"yes"==localStorage.getItem("is_updatevisitor"+b)&&i(b),"2"===(container=$("#tab-box-front-"+b)).attr("data-type")){let k=new Date;code="COUPONX"+k.getTime().toString().substring(4)+Math.random().toString().substring(2,3),$(".cx-code").val(code),$("#copy-coupon-inputcode-"+b).val(code),$(".code").text(code),$(".hide_coup_code").length&&($(".hide_coup_code").val(code),$(".coupon-email-button").attr("data-coupon-code",code)),$(".coupon-code-link").length&&"1"==$(".coupon-code-link").attr("data-type")&&(link=$(".coupon-code-link").attr("data-url")+code,$(".coupon-code-link").attr("href",link))}if(version=container.data("version"),(widget_version=localStorage.getItem("version"+b))!=version&&i(b),""!=$(".cx-code").val()&&"2"!=container.attr("data-type")){let l=$(".cx-code").data("valid");d("couponx_unique"+b,$(".cx-code").val(),l)}localStorage.setItem("version"+b,version),container.hasClass("couponapp-open-always")&&localStorage.removeItem("couponapp_close"+b),container.hasClass("couponapp-open-state-open")&&null==localStorage.getItem("couponapp_close_widget"+b)&&(g(b),container.addClass("couonapp-active"),container.removeClass("hide"),localStorage.setItem("couponapp_open"+b,"yes"),container.find(".tab-box-wrap").removeClass("hide")),d("countsticky","dismiss",1);let m=container.data("isexit"),c=container.data("delay"),j=container.data("scroll"),n=e("couponx-exist-"+b);"0"==c&&""==j&&"1"==m&&null==n&&container.addClass("hide"),("0"==c&&""==j||"yes"==localStorage.getItem("couponapp_show"+b))&&(container.removeClass("hide"),$(".tab-box-wrap").removeClass("hide")),parseInt(c)>0&&(delay=parseInt(c),setTimeout(function(c){container.removeClass("hide"),container.find(".tab-box-wrap").removeClass("hide");let a=container.find(".tab-box-email-content").outerWidth(),b=container.find(".coupon-button.coupon-email-button").outerWidth();void 0!==a&& void 0!==b&&container.find(".coupon-code-email-text").width(a-b-100),localStorage.setItem("couponapp_show"+c,"yes")},1e3*delay,b,container)),""!=j&&h(b),"yes"==localStorage.getItem("couponapp_tab_hide"+b)&&container.hasClass("couponapp-tab-hide")&&container.hide(),$(".tab-box.tab-front-box").each(function(){let a=$(this).find(".tab-box-email-content").outerWidth(),b=$(this).find(".coupon-button.coupon-email-button").outerWidth();void 0!==a&& void 0!==b&&$(this).find(".coupon-code-email-text").width(a-b-100)}),"yes"==localStorage.getItem("show_coupon_code"+b)&&(container.find(".tab-box-content.tab-box-email-content").remove(),container.addClass("open-coupon-code")),("yes"===localStorage.getItem("couponapp_pending_message"+b)||container.hasClass("couponapp-open-state-open"))&&container.find(".coupon-pending-message").remove(),container.hasClass("couponapp-open-state-open")&&(container.find(".tab-text").hide(),container.removeClass("hide"),container.find(".tab-box-wrap").removeClass("hide")),container.hasClass("couponapp-open-state-open")&&"yes"==localStorage.getItem("couponapp_close_widget"+b)&&container.hasClass("couponapp-open-always")&&container.find(".tab-text").show(),("yes"===localStorage.getItem("couponapp_open"+b)||container.hasClass("couponapp-open-state-open"))&&container.removeClass(function(b,a){return(a.match(/(^|\s)couponapp-\S+-animation/g)||[]).join(" ")}),!0== !!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&container.removeClass("couponapp-open-state-hover").removeClass("couponapp-open-state-open").addClass("couponapp-open-state-click");let o=localStorage.getItem("is_updatevisitor"+b);0==a&&"yes"!=o&&(name="couponx_unique"+b,document.cookie=escape(name)+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/; SameSite=Lax",f(b,"visitor"),a=1,localStorage.setItem("is_updatevisitor"+b,"yes"),document.cookie="cx_logged_"+b+"=1");let p=localStorage.getItem("is_updatecouponopen"+b);container.hasClass("couonapp-active")&&"yes"!=p&&(f(b,"widget_open"),localStorage.setItem("is_updatecouponopen"+b,"yes")),"close"===localStorage.getItem("couponapp_close"+b)&&container.find(".tab-text").hide()};$(".tab-front-box").each(function(){let a=$(this).data("widgetid");j(a)});let k=function(a,b){if((container=$("#"+b)).hasClass("couonapp-active")){container.removeClass("couonapp-active"),localStorage.setItem("couponapp_pending_message"+a,"yes"),localStorage.setItem("couponapp_close_widget"+a,"yes"),container.hasClass("couponapp-open-always")&&container.find(".tab-text").show();return}g(a);let c=localStorage.getItem("is_updatecouponopen"+a);container.hasClass("couonapp-active")||"yes"==c||(f(a,"widget_open"),localStorage.setItem("is_updatecouponopen"+a,"yes")),container.addClass("couonapp-active"),container.removeClass(function(b,a){return(a.match(/(^|\s)couponapp-\S+-animation/g)||[]).join(" ")}),"close"===localStorage.getItem("couponapp_close"+a)&&container.find(".tab-text").hide(),container.hasClass("couponapp-open-first")&&(localStorage.setItem("couponapp_close"+a,"close"),container.find(".tab-text").hide()),localStorage.setItem("couponapp_open"+a,"yes"),$("#"+b).find(".coupon-pending-message").length>0&&(localStorage.setItem("couponapp_pending_message"+a,"yes"),container.find(".coupon-pending-message").remove())};$(document).on("click touch",".couponapp-open-state-click .tab-icon",function(){let a=$(this).closest(".tab-box").attr("id"),b=$("#"+a).data("widgetid");k(b,a)}),$(document).on("click touch",".couponapp-open-state-hover-open .tab-icon",function(){let a=$(this).closest(".tab-box").attr("id"),b=$("#"+a).data("widgetid");if((container=$("#"+a)).hasClass("couonapp-active")){container.removeClass("couonapp-active"),localStorage.setItem("couponapp_pending_message"+b,"yes"),container.removeClass("couponapp-open-state-hover-open"),container.addClass("couponapp-open-state-click"),setTimeout(function(){container.addClass("couponapp-open-state-hover")},100);return}}),$(document).on("mouseenter touch",".couponapp-open-state-hover .tab-icon",function(){let b=$(this).closest(".tab-box").attr("id"),a=$("#"+b).data("widgetid");if(container=$("#"+b),g(a),container.hasClass("couonapp-active"))return;let c=localStorage.getItem("is_updatecouponopen"+a);$("#"+b).hasClass("couonapp-active")||"yes"==c||(f(a,"widget_open"),localStorage.setItem("is_updatecouponopen"+a,"yes")),container.removeClass(function(b,a){return(a.match(/(^|\s)couponapp-\S+-animation/g)||[]).join(" ")}),container.addClass("couonapp-active"),container.addClass("couponapp-open-state-click"),"close"===localStorage.getItem("couponapp_close"+a)&&container.find(".tab-text").hide(),container.hasClass("couponapp-open-first")&&(localStorage.setItem("couponapp_close"+a,"close"),container.find(".tab-text").hide()),localStorage.setItem("couponapp_open"+a,"yes"),container.find(".coupon-pending-message").length>0&&(localStorage.setItem("couponapp_pending_message"+a,"yes"),container.find(".coupon-pending-message").remove())}),$(document).on("click touch",".coupon-tab-close",function(c){c.preventDefault();let b=$(this).closest(".tab-box").attr("id"),a=$("#"+b).data("widgetid");(container=$("#"+b)).removeClass("couonapp-active"),$(this).parent().attr("style",""),localStorage.setItem("couponapp_close_widget"+a,"yes"),container.hasClass("couponapp-open-state-hover-open")&&container.addClass("couponapp-open-state-hover").removeClass("couponapp-open-state-hover-open"),container.removeClass(function(b,a){return(a.match(/(^|\s)couponapp-\S+-animation/g)||[]).join(" ")}),localStorage.setItem("couponapp_open"+a,"yes"),container.hasClass("coupon-pending-message")&&(localStorage.setItem("couponapp_pending_message"+a,"yes"),container.find(".coupon-pending-message").remove()),container.hasClass("couponapp-open-always")&&container.find(".tab-text").show()}),$(document).on("click touch",".copy-to-clipboard",function(d){d.preventDefault();let a=$(this).data("widget-id"),e=$("#copy-coupon-inputcode-"+a).val();var b=$("<input>");$("body").append(b),b.val(e).select(),document.execCommand("copy",!1,b.val()),b.remove(),$("#tab-box-front-"+a+" .coupon-code-text .label-tooltip").addClass("tooltip-show"),setTimeout(function(){$("#tab-box-front-"+a+" .coupon-code-text .label-tooltip").removeClass("tooltip-show")},1e3);let g=localStorage.getItem("is_updatecouponcodeget"+a);if($(this).hasClass("couoncode-copied")||"yes"==g||(f(a,"coupon"),localStorage.setItem("is_updatecouponcodeget"+a,"yes")),$(this).addClass("couoncode-copied"),void 0!==$("#tab-box-front-"+a).data("close-widget")){let c=$("#tab-box-front-"+a).data("close-widget");c=1e3*parseInt(c=c.toString().replace(/'/g,""));let h=function(a){$("#tab-box-front-"+a).removeClass("couonapp-active"),localStorage.setItem("couponapp_close_widget"+a,"yes")};setTimeout(h,c,a)}$("#tab-box-front-"+a).hasClass("couponapp-open-state-open")&&localStorage.setItem("couponapp_close_widget"+a,"yes"),$("#tab-box-front-"+a).hasClass("couponapp-tab-hide")&&localStorage.setItem("couponapp_tab_hide"+a,"yes")}),$(document).on("click touch",".coupon-code-link",function(d){let a=$(this).data("widget-id"),b=$("#tab-box-front-"+a),c=localStorage.getItem("is_updatecouponcodeget"+a);return $(this).hasClass("couoncode-copied")||"yes"==c||(f(a,"coupon"),localStorage.setItem("is_updatecouponcodeget"+a,"yes")),void 0!==b.data("close-widget")&&setTimeout(function(a){b.removeClass("couonapp-active"),localStorage.setItem("couponapp_close_widget"+a,"yes")},1e3*b.data("close-widget"),a),b.hasClass("couponapp-open-state-open")&&(localStorage.setItem("couponapp_close_widget"+a,"yes"),b.removeClass("couonapp-active")),b.hasClass("couponapp-tab-hide")&&localStorage.setItem("couponapp_tab_hide"+a,"yes"),!0}),$(document).on("click touch",".couponapp-open-state-open .tab-icon",function(c){let b=$(this).closest(".tab-box").attr("id"),a=$("#"+b).data("widgetid");(container=$("#"+b)).hasClass("couonapp-active")?(container.removeClass("couonapp-active"),localStorage.setItem("couponapp_open_widget"+a,"yes"),localStorage.setItem("couponapp_pending_message"+a,"yes"),localStorage.setItem("couponapp_close_widget"+a,"yes"),$("#"+b+" .coupon-pending-message").remove(),container.hasClass("couponapp-open-always")&&$("#"+b+" .tab-text").show()):(g(a),container.addClass("couonapp-active"),localStorage.setItem("couponapp_open"+a,"yes"))}),$(document).on("click",".coupon-email-button",function(g){let b=$(this).data("widget-id"),i="tab-box-front-"+b,c=$("#tab-box-front-"+b).find('.tab-box-email-content input[name="couponapp-email"]').val(),e=$(this).data("coupon-code");/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(c)||(c="");let a=$(this).data("consent-id"),f=$(this).data("consent");if(1==f&& !1==$("#"+a).prop("checked")&&"required"==$("#"+a).attr("required"))return!0;if(""!=b&&""!=c){g.preventDefault(),localStorage.setItem("couponapp_close_widget"+b,"yes");let h=cx_data.site_url+"/wp-json/couponx/v1/capture_email";$.post({url:h,headers:{"X-WP-Nonce":cx_data.nonce},data:{nonce:cx_data.nonce,email:c,widget_id:b,coupon_code:""!=e?e:"",is_consent:0!=$("#"+a).length&& !0==$("#"+a).prop("checked")?1:0},success:function(c){if(401==c.status&&($("#"+i+" .tab-box-email-content p.coupon-email-error").remove(),$("#"+i+" .tab-box-email-content .form-wrap").after('<p class="coupon-email-error">'+c.error+"</p>"),setTimeout(function(){$("#"+i+" .tab-box-email-content p.coupon-email-error").slideUp("slow")},5e3)),!0===c.show_coupon){let a=c.discount_code;if($("#"+i+" .cx-code").length>0&&$("#"+i+" .cx-code").val(a),$("#"+i+" .code").length>0&&$("#"+i+" .code").text(a),$("#copy-coupon-inputcode-"+b).length>0&&$("#copy-coupon-inputcode-"+b).val(a),$("#"+i+" .coupon-code-link").length>0&&2!=$("#"+i+" .coupon-code-link").attr("data-type")){let e=(href=$("#"+i+" .coupon-code-link").attr("data-url"))+a;$("#"+i+" .coupon-code-link").attr("href",e)}let f=$(".cx-code").data("valid");d("couponx_unique"+b,a,f),$("#"+i+" .tab-box-email-content").fadeOut(100);let g=function(a){$("#"+a+" .tab-box-couponcode-content").fadeIn("slow")};setTimeout(g,200,i),$("#"+i).addClass("couponapp-email-coupon-code-show"),$("#"+i).find(".tab-box-couponcode-content").removeClass("hide"),localStorage.setItem("show_coupon_code"+b,"yes")}}})}else if(1==f&& !1==$("#"+a).prop("checked")&&"required"==$("#"+a).attr("required")||""==c)return!0;return!1}),$(document).mouseleave(function(a){let b=a.clientY,c=document.body.clientWidth-a.pageX,f=$(window).height()-a.clientY;a.pageX,c>0&&f>0&&b<=0&&$(".tab-front-box").each(function(i,j){let h=$(this).data("isexit"),a=$(this).data("widgetid");var b=jQuery(this).attr("id");if("1"==h&&"yes"!==localStorage.getItem("couponapp_open"+a)&&null==e("couponx-exist-"+a)){g(a),$(this).removeClass("hide"),$("#"+b+" .tab-box-wrap").removeClass("hide"),$(this).addClass("couonapp-active"),$(this).addClass("couponapp-open-state-click"),d("couponx-exist-"+a,"yes",1),$(this).find(".coupon-pending-message").length&&(localStorage.setItem("couponapp_pending_message"+a,"yes"),$(".coupon-pending-message").remove()),$(this).removeClass(function(b,a){return(a.match(/(^|\s)couponapp-\S+-animation/g)||[]).join(" ")}),"close"===localStorage.getItem("couponapp_close"+a)&&$("#"+b+" .tab-text").hide(),$(this).hasClass("couponapp-open-first")&&(localStorage.setItem("couponapp_close"+a,"close"),$("#"+b+" .tab-text").hide()),localStorage.setItem("couponapp_open"+a,"yes");let c=$(this).find(".tab-box-email-content .form-wrap").outerWidth(),f=$(this).find(".coupon-button.coupon-email-button").outerWidth();void 0!==c&& void 0!==f&&$(this).find(".coupon-code-email-text").width(c-f-37)}})}),$(".close-an").click(function(a){a.preventDefault(),$(".coupon-tab-close").trigger("click"),$(this).closest(".tab-box").find(".tab-box-wrap").addClass("hide"),widget_id=$(this).closest(".tab-box").data("widgetid"),localStorage.setItem("couponapp_tab_hide"+widget_id,"yes")}),$(".open-an").click(function(a){a.preventDefault(),link=$(this).attr("url"),$(this).hasClass("blank")?window.open(link,"_blank"):location.href=link})});function get_cookie(c){var a=c+"=",b="";return document.cookie.length>0&& -1!=(offset=document.cookie.indexOf(a))&&(offset+=a.length,-1==(end=document.cookie.indexOf(";",offset))&&(end=document.cookie.length),b=unescape(document.cookie.substring(offset,end))),b}